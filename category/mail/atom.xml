<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: mail | The Dev Files]]></title>
  <link href="http://www.thedevfiles.com/category/mail/atom.xml" rel="self"/>
  <link href="http://www.thedevfiles.com/"/>
  <updated>2014-09-02T08:19:43-07:00</updated>
  <id>http://www.thedevfiles.com/</id>
  <author>
    <name><![CDATA[Jonathan Bernardi]]></name>
    <email><![CDATA[jon@jonbernardi.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Building a simple contact form in PHP - Part 2]]></title>
    <link href="http://www.thedevfiles.com/2014/09/building-a-simple-contact-form-in-php-part-2/"/>
    <updated>2014-09-02T00:00:00-07:00</updated>
    <id>http://www.thedevfiles.com/2014/09/building-a-simple-contact-form-in-php-part-2</id>
    <content type="html"><![CDATA[<p>In <a href="/2014/09/building-a-simple-contact-form-in-php-part-1">part 1</a> of <a href="/2014/09/building-a-simple-contact-form-in-php-part-1">Building a simple contact form in PHP</a> we built a simple contact form that sends a notification when the form is posted with the values the user posted.</p>

<p>As we discussed at the end of <a href="/2014/09/building-a-simple-contact-form-in-php-part-1">part 1</a> there are a few problems with our contact form.</p>

<p>We are going to work on solving some of those problems.</p>

<!--more-->


<p>The is what the contact form looked like as we last left it.</p>

<pre><code class="php contact.php">&lt;?php

// Check if the form has been posted
if (isset($_POST['name'], $_POST['email'], $_POST['message'])) {
    // The email address the email will be sent to
    $to = "business@example.com";
    // The email subject
    $subject = "Contact Form Submission";
    // Set the from and reply-to address for the email
    $headers = "From: website@example.com\r\n"
             . "X-Mailer: PHP/" . phpversion();
    // Build the body of the email
    $mailbody = "The contact form has been filled out.\n\n"
              . "Name: " . $_POST['name'] . "\n"
              . "Email: " . $_POST['email'] . "\n"
              . "Message:\n" . $_POST['message'];
    // Send the email
    mail($to, $subject, $mailbody);
    // Go to the thank you page
    header("location: thankyou.html");
    exit;

}

?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;title&gt;Contact Us&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action="contact.php" method="post" accept-charset="utf-8"&gt;
     &lt;fieldset&gt;
         &lt;legend&gt;Contact Us&lt;/legend&gt;
         &lt;div class="row"&gt;
             &lt;label for="name"&gt;Name: &lt;/label&gt;
             &lt;input id="name" type="text" name="name" value=""&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;label for="email"&gt;Email Address: &lt;/label&gt;
             &lt;input id="email" type="text" name="email" value=""&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;label for="message"&gt;Message:&lt;/label&gt;
             &lt;textarea id="message" name="message"&gt;&lt;/textarea&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;input type="submit" value="Submit"&gt;
         &lt;/div&gt;
     &lt;/fieldset&gt;
 &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2>Adding Form Validation</h2>

<p>Right now a user is able to submit a blank form and an email will still be sent.</p>

<p>We are going to add some server side validation so the form submission will only be accepted if the form is fully filled out.</p>

<p>We will also require the data entered in the email field to be a valid email address.</p>

<p>We will start by added a variable that we will use to store any validation error messages that we need to show to the user as well as a flag used to mark the form as failed validation.</p>

<p>Add the following to the top of the php code.</p>

<pre><code class="php">$valid = true;
$errors = array();
</code></pre>

<p>Next after the form is posted we will check that each field not empty.</p>

<p>Add the following code directly after the <code>if</code> and before email body is built.</p>

<pre><code class="php">if (empty($_POST['name'])) {
    $valid = false;
    $errors['name'] = "You must enter your name.";
}
if (empty($_POST['email'])) {
    $valid = false;
    $errors['email'] = "You must enter your email address.";
}
if (empty($_POST['message'])) {
    $valid = false;
    $errors['message'] = "You must enter a message.";
}
</code></pre>

<p>Now we need to only send the email if <code>$valid</code> is still true.  Wrap the email sending with a check to see if <code>$valid</code> is truthy.</p>

<p>The php code should now look like the following.</p>

<pre><code class="php">&lt;?php

$valid = true;
$errors = array();

// Check if the form has been posted
if (isset($_POST['name'], $_POST['email'], $_POST['message'])) {
    if (empty($_POST['name'])) {
        $valid = false;
        $errors['name'] = "You must enter your name.";
    }
    if (empty($_POST['email'])) {
        $valid = false;
        $errors['email'] = "You must enter your email address.";
    }
    if (empty($_POST['message'])) {
        $valid = false;
        $errors['message'] = "You must enter a message.";
    }
    if ($valid) {
        // The email address the email will be sent to
        $to = "business@example.com";
        // The email subject
        $subject = "Contact Form Submission";
        // Set the from and reply-to address for the email
        $headers = "From: website@example.com\r\n"
                 . "X-Mailer: PHP/" . phpversion();
        // Build the body of the email
        $mailbody = "The contact form has been filled out.\n\n"
                  . "Name: " . $_POST['name'] . "\n"
                  . "Email: " . $_POST['email'] . "\n"
                  . "Message:\n" . $_POST['message'];
        // Send the email
        mail($to, $subject, $mailbody);
        // Go to the thank you page
        header("location: thankyou.html");
        exit;
    }
}

?&gt;
</code></pre>

<p>Note that I am using the <a href="http://us2.php.net/manual/en/function.empty.php">empty</a> function to check if the form field is not empty.
The empty function only checks if a value is falsey.  Since php is a loosely-typed language an empty string or even the string &ldquo;0&rdquo; will evaluate to false.
This means if the user enters the number <code>0</code> in a field the form validation will determine that the field is empty.
For this form that is fine as <code>0</code> is not valid entry for any of the fields we have but if we have a form field where 0 is a valid answer we could not use the <code>empty</code> function to validate that field.</p>

<p>Now we need to show these validation error messages to the user when they submit the form.</p>

<p>Add the following to the form right after the <code>&lt;legend&gt;</code> field.</p>

<pre><code class="php">&lt;?php if (!$valid): ?&gt;
    &lt;div class="error"&gt;
        &lt;?php foreach($errors as $message):?&gt;
            &lt;div&gt;&lt;?php echo htmlspecialchars($message); ?&gt;&lt;/div&gt;
        &lt;?php endforeach; ?&gt;
    &lt;/div&gt;
&lt;?php endif; ?&gt;
</code></pre>

<p>Now, when the user submits the form without filling out one or more of the fields no email will be sent and the messages will be shown to the user.</p>

<h3>Email Address Validation</h3>

<p>Since the main purpose of a contact form is to allow communication with users we need to make sure that the value entered in the email field is an email address rather then just checking if the field is not empty.</p>

<p>We will use the <a href="http://us2.php.net/manual/en/function.filter-input.php">filter_input</a> to validate the email address.</p>

<p>Change the validation for the email field to the following</p>

<pre><code class="php">if (empty($_POST['email'])) {
    $valid = false;
    $errors['email'] = "You must enter your email address.";
} elseif (!filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL)) {
    $valid = false;
    $errors['email'] = "You must enter a valid email address.";
}
</code></pre>

<p>Our full contact.php page should now look like this.</p>

<pre><code class="php contact.php">&lt;?php

$valid = true;
$errors = array();

// Check if the form has been posted
if (isset($_POST['name'], $_POST['email'], $_POST['message'])) {
    if (empty($_POST['name'])) {
        $valid = false;
        $errors['name'] = "You must enter your name.";
    }
    if (empty($_POST['email'])) {
        $valid = false;
        $errors['email'] = "You must enter your email address.";
    } elseif (!filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL)) {
        $valid = false;
        $errors['email'] = "You must enter a valid email address.";
    }
    if (empty($_POST['message'])) {
        $valid = false;
        $errors['message'] = "You must enter a message.";
    }
    if ($valid) {
        // The email address the email will be sent to
        $to = "business@example.com";
        // The email subject
        $subject = "Contact Form Submission";
        // Set the from and reply-to address for the email
        $headers = "From: website@example.com\r\n"
                 . "X-Mailer: PHP/" . phpversion();
        // Build the body of the email
        $mailbody = "The contact form has been filled out.\n\n"
                  . "Name: " . $_POST['name'] . "\n"
                  . "Email: " . $_POST['email'] . "\n"
                  . "Message:\n" . $_POST['message'];
        // Send the email
        mail($to, $subject, $mailbody);
        // Go to the thank you page
        header("location: thankyou.html");
        exit;
    }
}

?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;title&gt;Contact Us&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action="contact.php" method="post" accept-charset="utf-8"&gt;
        &lt;fieldset&gt;
            &lt;legend&gt;Contact Us&lt;/legend&gt;
            &lt;?php if (!$valid): ?&gt;
                &lt;div class="error"&gt;
                    &lt;?php foreach($errors as $message):?&gt;
                        &lt;div&gt;&lt;?php echo htmlspecialchars($message); ?&gt;&lt;/div&gt;
                    &lt;?php endforeach; ?&gt;
                &lt;/div&gt;
            &lt;?php endif; ?&gt;
            &lt;div class="row"&gt;
                &lt;label for="name"&gt;Name: &lt;/label&gt;
                &lt;input id="name" type="text" name="name" value=""&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;label for="email"&gt;Email Address: &lt;/label&gt;
                &lt;input id="email" type="text" name="email" value=""&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;label for="message"&gt;Message:&lt;/label&gt;
                &lt;textarea id="message" name="message"&gt;&lt;/textarea&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;input type="submit" value="Submit"&gt;
            &lt;/div&gt;
        &lt;/fieldset&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h3>Repopulating the Form</h3>

<p>We are giving users messages telling them they need to fill out all of the fields but we still need to repopulate the form with the values they submitted.</p>

<p>There is little more annoying to users than filling out a form only to be told they did it wrong and being forced to do it all over again.</p>

<p>What if they spent time typing out a long message but forgot to fill out the name field?
They will once again be staring at a blank form.
They will more likely just leave rather than retype their message.</p>

<p>To repopulate the form we will need some variables to store the posted data in.</p>

<p>Add the following above the mail sending code.</p>

<pre><code class="php">$contact = array(
    'name' =&gt; null,
    'email' =&gt; null,
    'message' =&gt; null
);
</code></pre>

<p>This will initialize the variable so we don&rsquo;t have to check if the form was posted in the middle of our html.</p>

<p>Change the form fields to the following.</p>

<p>```php</p>

<div class="row">
    <label for="name">Name: </label>
    <input id="name" type="text" name="name" value="<?php echo htmlspecialchars($contact['name']);?>">
</div>


<div class="row">
    <label for="email">Email Address: </label>
    <input id="email" type="text" name="email" value="<?php echo htmlspecialchars($contact['email']);?>">
</div>


<div class="row">
    <label for="message">Message:</label>
    <textarea id="message" name="message"><?php echo htmlspecialchars($contact['message']);?></textarea>
</div>


<pre><code>
We are using [htmlspecialchars](http://us2.php.net/manual/en/function.htmlspecialchars.php) to escape the data to prevent [cross-site scripting](http://en.wikipedia.org/wiki/Cross-site_scripting) attacks.

While we are on the subject of security we are also going to add some filtering to the input before sending the emails.
While we are sending plain text emails we don't want to trust that whatever email client is used to read the email wont try to do something like try to run something posted to the form.

Add the following code right before the form validation.
</code></pre>

<p>$contact = filter_input_array(INPUT_POST, array(
    &lsquo;name&rsquo;   => FILTER_SANITIZE_STRING,
    &lsquo;email&rsquo;   => FILTER_SANITIZE_STRING,
    &lsquo;message&rsquo;   => FILTER_SANITIZE_STRING,
), true);
```</p>

<p>Now anywhere in the validation or email sending code that references <code>$_POST</code> should be changed to <code>$contact</code></p>

<p><img src="/images/contact-form/part-2/validation.png" alt="Form Validation" /></p>

<h3>Using the posted email address as the Reply-To address</h3>

<p>Now that we have validated that the email address field contains an email address we can use the email address the user submitted as the Reply-To address for the email.
This will allow you to hit reply in your email client to send a reply directly to the user.</p>

<p>Change the <code>$headers</code> line to the following.</p>

<pre><code class="php">$headers = "From: website@example.com\r\n"
 . "Reply-To: " . $contact['email'] . "\r\n"
 . "X-Mailer: PHP/" . phpversion();
</code></pre>

<p> The full <code>contact.php</code> should now look like the following.</p>

<pre><code class="php contact.php">&lt;?php

$valid = true;
$errors = array();

$contact = array(
    'name' =&gt; null,
    'email' =&gt; null,
    'message' =&gt; null
);

// Check if the form has been posted
if (isset($_POST['name'], $_POST['email'], $_POST['message'])) {
    $contact = filter_input_array(INPUT_POST, array(
        'name'   =&gt; FILTER_SANITIZE_STRING,
        'email'   =&gt; FILTER_SANITIZE_STRING,
        'message'   =&gt; FILTER_SANITIZE_STRING,
    ), true);
    if (empty($contact['name'])) {
        $valid = false;
        $errors['name'] = "You must enter your name.";
    }
    if (empty($contact['email'])) {
        $valid = false;
        $errors['email'] = "You must enter your email address.";
    } elseif (!filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL)) {
        $valid = false;
        $errors['email'] = "You must enter a valid email address.";
    }
    if (empty($contact['message'])) {
        $valid = false;
        $errors['message'] = "You must enter a message.";
    }
    if ($valid) {
        // The email address the email will be sent to
        $to = "business@example.com";
        // The email subject
        $subject = "Contact Form Submission";
        // Set the from and reply-to address for the email
        $headers = "From: website@example.com\r\n"
                 . "Reply-To: " . $contact['email'] . "\r\n"
                 . "X-Mailer: PHP/" . phpversion();
        // Build the body of the email
        $mailbody = "The contact form has been filled out.\n\n"
                  . "Name: " . $contact['name'] . "\n"
                  . "Email: " . $contact['email'] . "\n"
                  . "Message:\n" . $contact['message'];
        // Send the email
        mail($to, $subject, $mailbody);
        // Go to the thank you page
        header("location: thankyou.html");
        exit;
    }
}

?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;title&gt;Contact Us&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action="contact.php" method="post" accept-charset="utf-8"&gt;
        &lt;fieldset&gt;
            &lt;legend&gt;Contact Us&lt;/legend&gt;
            &lt;?php if (!$valid): ?&gt;
                &lt;div class="error"&gt;
                    &lt;?php foreach($errors as $message):?&gt;
                        &lt;div&gt;&lt;?php echo htmlspecialchars($message); ?&gt;&lt;/div&gt;
                    &lt;?php endforeach; ?&gt;
                &lt;/div&gt;
            &lt;?php endif; ?&gt;
            &lt;div class="row"&gt;
                &lt;label for="name"&gt;Name: &lt;/label&gt;
                &lt;input id="name" type="text" name="name" value="&lt;?php echo htmlspecialchars($contact['name']);?&gt;"&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;label for="email"&gt;Email Address: &lt;/label&gt;
                &lt;input id="email" type="text" name="email" value="&lt;?php echo htmlspecialchars($contact['email']);?&gt;"&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;label for="message"&gt;Message:&lt;/label&gt;
                &lt;textarea id="message" name="message"&gt;&lt;?php echo htmlspecialchars($contact['message']);?&gt;&lt;/textarea&gt;
            &lt;/div&gt;
            &lt;div class="row"&gt;
                &lt;input type="submit" value="Submit"&gt;
            &lt;/div&gt;
        &lt;/fieldset&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2>Summary</h2>

<p>We have added server-side form validation, input sanitation, repopulated the form on failed validation, and set the Reply-To header.</p>

<p>Next time we are going to add some client-side form validation to make the user experience a bit more pleasant.</p>

<p>We will also going to add some anti-spam protection to the form.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building a simple contact form in PHP - Part 1]]></title>
    <link href="http://www.thedevfiles.com/2014/09/building-a-simple-contact-form-in-php-part-1/"/>
    <updated>2014-09-01T00:00:00-07:00</updated>
    <id>http://www.thedevfiles.com/2014/09/building-a-simple-contact-form-in-php-part-1</id>
    <content type="html"><![CDATA[<p>In this series we will be building a simple contact form in php.</p>

<p>It will cover sending emails and form validation.</p>

<!--more-->


<h2>Creating the Contact Form</h2>

<p>We will start with the form itself.</p>

<pre><code class="html contact.php">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;title&gt;Contact Us&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action="contact.php" method="post" accept-charset="utf-8"&gt;
     &lt;fieldset&gt;
         &lt;legend&gt;Contact Us&lt;/legend&gt;
         &lt;div class="row"&gt;
             &lt;label for="name"&gt;Name: &lt;/label&gt;
             &lt;input id="name" type="text" name="name" value=""&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;label for="email"&gt;Email Address: &lt;/label&gt;
             &lt;input id="email" type="text" name="email" value=""&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;label for="message"&gt;Message:&lt;/label&gt;
             &lt;textarea id="message" name="message"&gt;&lt;/textarea&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;input type="submit" value="Submit"&gt;
         &lt;/div&gt;
     &lt;/fieldset&gt;
 &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>We will also add a stylesheet with some basic styles for the form.</p>

<pre><code class="css styles.css">fieldset {
    margin:0 auto;
    width: 235px;
}
legend {
    font-weight:bold;
    font-size:125%;
}
form div.row {
    margin-bottom: 8px;
}
label {
    display: block;
    font-weight:bold;
}
input[type=text],input[type=email] {
    display:block;
    width: 400px;
}

textarea {
    width: 400px;
    height:200px;
}
</code></pre>

<p>If you view the page in a browser it should look something like this.</p>

<p><img src="/images/contact-form/part-1/contact-form.png" alt="Contact Form" /></p>

<p>Not the prettiest form but this isn&rsquo;t a design tutorial.
Feel free to add your own styles.</p>

<p>We also will need a page to send the user to after they submit the form.
This should have some sort of &ldquo;Thank you for submitting&rdquo; message on it.</p>

<pre><code class="html thankyou.html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;title&gt;Contact Us&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt;Thank you for your message.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2>Sending an email on form post.</h2>

<p>We have a form but it doesn&rsquo;t do anything when the user submits it.</p>

<p>Add the following to the top of the contact.php page above the <code>&lt;!DOCTYPE html&gt;</code> line.</p>

<pre><code class="php contact.php">&lt;?php

// Check if the form has been posted
if (isset($_POST['name'], $_POST['email'], $_POST['message'])) {
    // The email address the email will be sent to
    $to = "business@example.com";
    // The email subject
    $subject = "Contact Form Submission";
    // Set the from and reply-to address for the email
    $headers = "From: website@example.com\r\n"
             . "X-Mailer: PHP/" . phpversion();
    // Build the body of the email
    $mailbody = "The contact form has been filled out.\n\n"
              . "Name: " . $_POST['name'] . "\n"
              . "Email: " . $_POST['email'] . "\n"
              . "Message:\n" . $_POST['message'];
    // Send the email
    mail($to, $subject, $mailbody);
    // Go to the thank you page
    header("location: thankyou.html");
    exit;

}

?&gt;
</code></pre>

<p>The entire page should not look like this.</p>

<pre><code class="php contact.php">&lt;?php

// Check if the form has been posted
if (isset($_POST['name'], $_POST['email'], $_POST['message'])) {
    // The email address the email will be sent to
    $to = "business@example.com";
    // The email subject
    $subject = "Contact Form Submission";
    // Set the from and reply-to address for the email
    $headers = "From: website@example.com\r\n"
             . "X-Mailer: PHP/" . phpversion();
    // Build the body of the email
    $mailbody = "The contact form has been filled out.\n\n"
              . "Name: " . $_POST['name'] . "\n"
              . "Email: " . $_POST['email'] . "\n"
              . "Message:\n" . $_POST['message'];
    // Send the email
    mail($to, $subject, $mailbody);
    // Go to the thank you page
    header("location: thankyou.html");
    exit;

}

?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;title&gt;Contact Us&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action="contact.php" method="post" accept-charset="utf-8"&gt;
     &lt;fieldset&gt;
         &lt;legend&gt;Contact Us&lt;/legend&gt;
         &lt;div class="row"&gt;
             &lt;label for="name"&gt;Name: &lt;/label&gt;
             &lt;input id="name" type="text" name="name" value=""&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;label for="email"&gt;Email Address: &lt;/label&gt;
             &lt;input id="email" type="text" name="email" value=""&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;label for="message"&gt;Message:&lt;/label&gt;
             &lt;textarea id="message" name="message"&gt;&lt;/textarea&gt;
         &lt;/div&gt;
         &lt;div class="row"&gt;
             &lt;input type="submit" value="Submit"&gt;
         &lt;/div&gt;
     &lt;/fieldset&gt;
 &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h3>How does it work?</h3>

<p>First we are checking if each of the form fields have been posted.
If they exist the user has submitted the form.</p>

<pre><code class="php">if (isset($_POST['name'], $_POST['email'], $_POST['message'])) {
</code></pre>

<p>Next we define where we would like the email to be sent and what the subject of the email should be.<br/>
Change the <code>$to</code> variable to your own email address.</p>

<pre><code class="php">// The email address the email will be sent to
$to = "business@example.com";
// The email subject
$subject = "Contact Form Submission";
</code></pre>

<p>The headers set the email address used for the from in the email.
The other line indicates the application used to send the email.  In this case php.</p>

<pre><code class="php">// Set the from and reply-to address for the email
$headers = "From: website@example.com\r\n"
         . "X-Mailer: PHP/" . phpversion();
</code></pre>

<p>We now need to build the body of the email itself.
It should include each of the posted values.</p>

<pre><code class="php">// Build the body of the email
$mailbody = "The contact form has been filled out.\n\n"
          . "Name: " . $_POST['name'] . "\n"
          . "Email: " . $_POST['email'] . "\n"
          . "Message:\n" . $_POST['message'];
</code></pre>

<p>Next we use the <a href="http://us3.php.net/manual/en/book.mail.php">php mail</a> function to actually send the email.</p>

<pre><code class="php">// Send the email
mail($to, $subject, $mailbody);
</code></pre>

<p>Finally we send the user to the thankyou.html page that we created.</p>

<pre><code class="php">// Go to the thank you page
header("location: thankyou.html");
exit;
</code></pre>

<h2>Improving the script</h2>

<p>While this script would work as is for your contact form it have a number of problems with it.</p>

<p>The biggest one is that there is no form validation.<br/>
A user can submit a blank form and it will send the email and redirect to the thankyou.html page anyway.</p>

<p>The data the user is submitting is not being escaped or filtered.<br/>
We only want plain text being submitted through the form but without any enforcement of that the user can submit anything including scripts that might cause security issues with certain email clients.</p>

<p>There is nothing to help prevent spam.<br/>
Once a spam-bot finds this script you could find your inbox full of worthless junk.</p>

<p>In the next part I will tackle some of these issues.</p>
]]></content>
  </entry>
  
</feed>
